<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GameCollector Responsive</title>

<style>
body{
margin:0;
font-family:Segoe UI,Arial;
background:#1e2124;
color:white;
}

/* HEADER */
header{
background:#23272A;
padding:20px;
display:flex;
justify-content:space-between;
align-items:center;
flex-wrap:wrap;
gap:10px;
}

header input{
padding:8px;
border:none;
border-radius:6px;
background:#2C2F33;
color:white;
}

/* ADD SECTION */
.add-section{
padding:20px;
background:#2C2F33;
display:flex;
gap:10px;
flex-wrap:wrap;
position:relative;
}

input,select,button{
padding:8px;
border:none;
border-radius:6px;
background:#2C2F33;
color:white;
}

button{
background:#5865F2;
cursor:pointer;
}

button:hover{
background:#4752C4;
}

/* AUTOCOMPLETE */
.autocomplete-box{
position:absolute;
top:60px;
left:20px;
width:250px;
background:#23272A;
border-radius:6px;
max-height:250px;
overflow-y:auto;
display:none;
z-index:999;
border:1px solid #444;
}

.autocomplete-item{
display:flex;
gap:8px;
padding:8px;
cursor:pointer;
align-items:center;
}

.autocomplete-item:hover{
background:#2C2F33;
}

.autocomplete-item img{
width:40px;
height:55px;
object-fit:cover;
border-radius:4px;
}

/* LIBRARY */
.system-section{
padding:20px;
}

.system-title{
font-size:18px;
margin-bottom:10px;
}

.carousel{
display:flex;
gap:15px;
overflow-x:auto;
}

.card{
min-width:180px;
background:#23272A;
padding:10px;
border-radius:10px;
display:flex;
flex-direction:column;
}

.card img{
width:100%;
height:260px;
object-fit:cover;
border-radius:6px;
}

.card-buttons{
display:flex;
gap:5px;
margin-top:5px;
flex-wrap:wrap;
}

.card h4{
margin:8px 0 5px 0;
font-size:14px;
}

/* MODAL */
.modal{
position:fixed;
inset:0;
background:rgba(0,0,0,.7);
display:none;
justify-content:center;
align-items:center;
}

.modal-content{
background:#23272A;
padding:20px;
border-radius:10px;
width:300px;
display:flex;
flex-direction:column;
gap:10px;
}

/* RESPONSIVE */
@media(max-width:600px){
.carousel{
flex-direction:column;
}
.card{
width:100%;
}
}
</style>
</head>

<body>

<header>
<h2>ðŸŽ® GameCollector</h2>
<input id="search" placeholder="Suchen...">
</header>

<div class="add-section">

<div style="position:relative;">
<input id="title" placeholder="Titel" autocomplete="off">
<div id="autocompleteResults" class="autocomplete-box"></div>
</div>

<select id="system">
<option value="">System wÃ¤hlen</option>
<option>NES</option><option>SNES</option><option>N64</option>
<option>GameCube</option><option>Wii</option><option>Switch</option>
<option>Game Boy</option><option>Nintendo DS</option>
<option>PS1</option><option>PS2</option><option>PS3</option>
<option>PS4</option><option>PS5</option>
<option>Xbox</option><option>Xbox 360</option>
<option>Xbox One</option>
<option>PC</option>
</select>

<input type="file" id="coverUpload" accept="image/*">
<button id="addBtn">HinzufÃ¼gen</button>

</div>

<div id="library"></div>

<div class="modal" id="editModal">
<div class="modal-content">
<h3>Bearbeiten</h3>
<input id="editTitle">
<select id="editSystem">
<option>NES</option><option>SNES</option><option>N64</option>
<option>GameCube</option><option>Wii</option><option>Switch</option>
<option>Game Boy</option><option>Nintendo DS</option>
<option>PS1</option><option>PS2</option><option>PS3</option>
<option>PS4</option><option>PS5</option>
<option>Xbox</option><option>Xbox 360</option>
<option>Xbox One</option>
<option>PC</option>
</select>
<input type="file" id="editCover">
<button id="saveEditBtn">Speichern</button>
<button onclick="closeModal()">Abbrechen</button>
</div>
</div>

<script>
const API_KEY="fd6918aa2d024a1fa2331ccbde183ae7";

const titleInput=document.getElementById("title");
const systemSelect=document.getElementById("system");
const coverUpload=document.getElementById("coverUpload");
const searchInput=document.getElementById("search");
const library=document.getElementById("library");
const autocompleteBox=document.getElementById("autocompleteResults");
const addBtn=document.getElementById("addBtn");

const editModal=document.getElementById("editModal");
const editTitle=document.getElementById("editTitle");
const editSystem=document.getElementById("editSystem");
const editCover=document.getElementById("editCover");
const saveEditBtn=document.getElementById("saveEditBtn");

let games=JSON.parse(localStorage.getItem("games"))||[];
let editId=null;
let selectedCoverUrl="";

/* SAVE */
function save(){
localStorage.setItem("games",JSON.stringify(games));
}

/* AUTOCOMPLETE */
titleInput.addEventListener("input",async()=>{
let query=titleInput.value;
if(query.length<2){
autocompleteBox.style.display="none";
return;
}

try{
let res=await fetch(`https://api.rawg.io/api/games?key=${API_KEY}&search=${encodeURIComponent(query)}&page_size=5`);
let data=await res.json();

autocompleteBox.innerHTML="";
autocompleteBox.style.display="block";

data.results.forEach(game=>{
let div=document.createElement("div");
div.className="autocomplete-item";
div.innerHTML=`
${game.background_image?`<img src="${game.background_image}">`:''}
<span>${game.name}</span>
`;
div.onclick=()=>{
titleInput.value=game.name;
selectedCoverUrl=game.background_image||"";
autocompleteBox.style.display="none";
};
autocompleteBox.appendChild(div);
});
}catch(e){
autocompleteBox.style.display="none";
}
});

/* ADD */
addBtn.addEventListener("click",async()=>{
let t=titleInput.value;
let s=systemSelect.value;
let f=coverUpload.files[0];

if(!t||!s){
alert("Titel & System nÃ¶tig");
return;
}

if(f){
let r=new FileReader();
r.onload=e=>{
games.push({id:Date.now(),title:t,system:s,cover:e.target.result});
save();render();
};
r.readAsDataURL(f);
}
else if(selectedCoverUrl){
try{
let imgRes=await fetch(selectedCoverUrl);
let blob=await imgRes.blob();
let r=new FileReader();
r.onloadend=function(){
games.push({id:Date.now(),title:t,system:s,cover:r.result});
save();render();
};
r.readAsDataURL(blob);
}catch(e){
games.push({id:Date.now(),title:t,system:s,cover:""});
save();render();
}
}
else{
games.push({id:Date.now(),title:t,system:s,cover:""});
save();render();
}

titleInput.value="";
coverUpload.value="";
selectedCoverUrl="";
});

/* SEARCH */
searchInput.addEventListener("input",render);

/* EDIT */
function openEdit(id){
let g=games.find(x=>x.id===id);
editId=id;
editTitle.value=g.title;
editSystem.value=g.system;
editModal.style.display="flex";
}

saveEditBtn.addEventListener("click",()=>{
let g=games.find(x=>x.id===editId);
g.title=editTitle.value;
g.system=editSystem.value;

let f=editCover.files[0];
if(f){
let r=new FileReader();
r.onload=e=>{
g.cover=e.target.result;
save();render();
};
r.readAsDataURL(f);
}else{
save();render();
}
closeModal();
});

function closeModal(){
editModal.style.display="none";
}

/* DELETE */
function deleteGame(id){
games=games.filter(g=>g.id!==id);
save();render();
}

/* RENDER */
function render(){
library.innerHTML="";
let searchVal=searchInput.value.toLowerCase();
let filtered=games.filter(g=>g.title.toLowerCase().includes(searchVal));
let systems=[...new Set(filtered.map(g=>g.system))];

systems.sort((a,b)=>a.localeCompare(b,'de',{sensitivity:'base'}));

systems.forEach(sys=>{
let sec=document.createElement("div");
sec.className="system-section";
sec.innerHTML=`<div class="system-title">${sys}</div><div class="carousel"></div>`;
library.appendChild(sec);

let car=sec.querySelector(".carousel");

filtered.filter(g=>g.system===sys)
.sort((a,b)=>a.title.localeCompare(b.title,'de',{sensitivity:'base'}))
.forEach(g=>{
car.innerHTML+=`
<div class="card">
${g.cover?`<img src="${g.cover}" onerror="this.remove()">`:''}
<h4>${g.title}</h4>
<div class="card-buttons">
<button onclick="openEdit(${g.id})">Bearbeiten</button>
<button onclick="deleteGame(${g.id})">LÃ¶schen</button>
</div>
</div>`;
});
});
}

render();
</script>

</body>
</html>
