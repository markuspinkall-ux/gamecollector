<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GameCollector Space Edition</title>

<style>
body{
margin:0;
font-family:Segoe UI,Arial;
background:transparent;
color:white;
overflow-x:hidden;
}

/* Canvas Hintergrund */
canvas{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
z-index:0;
pointer-events:none;
}

/* Content Layer */
header, .add-section, #library{
position:relative;
z-index:2;
}

/* Header */
header{
background:rgba(20,20,30,0.9);
padding:15px;
display:flex;
justify-content:space-between;
align-items:center;
flex-wrap:wrap;
gap:10px;
}

header input{
padding:8px;
border:none;
border-radius:6px;
background:#2C2F33;
color:white;
}

/* View Switch */
.view-switch{
display:flex;
gap:10px;
}

.view-switch button{
padding:6px 12px;
border:none;
border-radius:6px;
cursor:pointer;
background:#333;
color:white;
font-weight:bold;
}

.view-switch button.active{
background:#ff00aa;
}

/* Add Section */
.add-section{
padding:15px;
background:rgba(20,20,30,0.9);
display:flex;
flex-wrap:wrap;
gap:10px;
}

.add-section input,
.add-section select,
.add-section button{
padding:8px;
border:none;
border-radius:6px;
background:#2C2F33;
color:white;
}

.add-section button{
background:#ff00aa;
cursor:pointer;
}

/* Autocomplete */
.autocomplete-box{
background:#23272A;
border-radius:6px;
max-height:250px;
overflow-y:auto;
box-shadow:0 10px 30px rgba(0,0,0,.6);
width:100%;
}

.autocomplete-item{
display:flex;
gap:8px;
padding:8px;
cursor:pointer;
align-items:center;
}

.autocomplete-item img{
width:40px;
height:55px;
object-fit:cover;
border-radius:4px;
}

/* System Section */
.system-section{
padding:20px;
}

.system-title{
font-size:20px;
margin-bottom:15px;
color:#00ffff;
text-shadow:0 0 10px #00ffff;
}

/* GRID VIEW */
.carousel{
display:flex;
gap:15px;
overflow-x:auto;
scroll-snap-type:x mandatory;
}

.card{
min-width:160px;
border-radius:12px;
overflow:hidden;
background:#111;
scroll-snap-align:start;
display:flex;
flex-direction:column;
position:relative;
border:1px solid #ff00aa;
}

.card img{
width:100%;
height:220px;
object-fit:cover;
}

.card-title{
padding:8px;
text-align:center;
}

/* LIST VIEW */
.list-view .carousel{
display:block;
}

.list-view .card{
flex-direction:row;
min-width:100%;
height:100px;
margin-bottom:10px;
}

.list-view .card img{
width:70px;
height:100%;
}

.list-view .card-title{
flex:1;
display:flex;
align-items:center;
padding-left:15px;
text-align:left;
}

/* Icons */
.card-icons{
position:absolute;
top:8px;
right:8px;
display:flex;
gap:6px;
}

.icon-btn{
width:28px;
height:28px;
border-radius:50%;
border:none;
cursor:pointer;
font-size:14px;
display:flex;
align-items:center;
justify-content:center;
color:white;
}

.edit-btn{ background:#00ffff; color:black; }
.delete-btn{ background:#ff0066; }

@media(min-width:768px){
header input{ width:300px; }
.card{ min-width:200px; }
.card img{ height:280px; }
}
</style>
</head>

<body>

<canvas id="bg"></canvas>

<header>
<div>
<h2>üéÆ GameCollector Space Edition</h2>
<input id="search" placeholder="Suchen..." oninput="render()">
</div>

<div class="view-switch">
<button id="gridBtn" onclick="setView('grid')">Grid</button>
<button id="listBtn" onclick="setView('list')">Liste</button>
</div>
</header>

<div class="add-section">
<input id="title" placeholder="Titel" oninput="autoComplete()" autocomplete="off">
<div id="autocompleteResults" class="autocomplete-box" style="display:none;"></div>

<select id="system">
<option value="">System w√§hlen</option>
<option>NES</option><option>SNES</option><option>N64</option>
<option>GameCube</option><option>Wii</option><option>Switch</option>
<option>Game Boy</option><option>Nintendo DS</option>
<option>PS1</option><option>PS2</option><option>PS3</option>
<option>PS4</option><option>PS5</option>
<option>Xbox</option><option>Xbox 360</option>
<option>PC</option>
</select>

<button onclick="addGame()">Hinzuf√ºgen</button>
</div>

<div id="library"></div>

<script>

const API_KEY = "fd6918aa2d024a1fa2331ccbde183ae7";

/* ===== VIEW MODE ===== */
let currentView = localStorage.getItem("viewMode") || "grid";

function setView(mode){
currentView = mode;
localStorage.setItem("viewMode",mode);
updateViewButtons();
render();
}

function updateViewButtons(){
document.getElementById("gridBtn").classList.remove("active");
document.getElementById("listBtn").classList.remove("active");
if(currentView==="grid") document.getElementById("gridBtn").classList.add("active");
if(currentView==="list") document.getElementById("listBtn").classList.add("active");
}

updateViewButtons();

/* ===== SPACE INVADERS WALLPAPER ===== */

const canvas = document.getElementById("bg");
const ctx = canvas.getContext("2d");

function resize(){
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);
window.addEventListener("orientationchange", resize);

let stars=[];
for(let i=0;i<100;i++){
stars.push({
x:Math.random()*canvas.width,
y:Math.random()*canvas.height,
speed:Math.random()*0.5+0.2,
size:Math.random()*2
});
}

const invaderPattern=[
"00111100",
"01111110",
"11111111",
"11011011",
"11111111",
"00100100",
"01000010",
"10000001"
];

let invaders=[];
let rows=4;
let cols=8;
let spacing=70;
let invaderOffset=0;
let direction=1;
let drop=0;

function createInvaders(){
invaders=[];
for(let r=0;r<rows;r++){
for(let c=0;c<cols;c++){
invaders.push({x:c*spacing,y:r*spacing,alive:true});
}
}
}
createInvaders();

let bullets=[];
setInterval(()=>{
bullets.push({x:canvas.width/2,y:canvas.height-60});
},1200);

let ufoX=-200;
let explosions=[];

function drawInvader(x,y){
const pixel=4;
ctx.fillStyle="#00ffff";
ctx.shadowColor="#00ffff";
ctx.shadowBlur=15;
for(let row=0;row<invaderPattern.length;row++){
for(let col=0;col<8;col++){
if(invaderPattern[row][col]==="1"){
ctx.fillRect(x+col*pixel,y+row*pixel,pixel,pixel);
}
}
}
ctx.shadowBlur=0;
}

function drawPlayer(){
ctx.fillStyle="#ff00aa";
ctx.shadowColor="#ff00aa";
ctx.shadowBlur=20;
ctx.fillRect(canvas.width/2-20,canvas.height-50,40,15);
ctx.shadowBlur=0;
}

function drawBackground(){
const w=canvas.width;
const h=canvas.height;

ctx.clearRect(0,0,w,h);

let gradient=ctx.createLinearGradient(0,0,0,h);
gradient.addColorStop(0,"#1a0033");
gradient.addColorStop(1,"#000");
ctx.fillStyle=gradient;
ctx.fillRect(0,0,w,h);

stars.forEach(s=>{
ctx.fillStyle="white";
ctx.fillRect(s.x,s.y,s.size,s.size);
s.y+=s.speed;
if(s.y>h){s.y=0;s.x=Math.random()*w;}
});

ctx.fillStyle="#ffcc00";
ctx.shadowColor="#ffcc00";
ctx.shadowBlur=20;
ctx.fillRect(ufoX,60,60,20);
ctx.shadowBlur=0;
ufoX+=2;
if(ufoX>w+100) ufoX=-200;

invaderOffset+=direction*1.2;
if(invaderOffset>80||invaderOffset<-80){
direction*=-1;
drop+=15;
}

invaders.forEach(inv=>{
if(inv.alive){
drawInvader(
w/2-(cols*spacing)/2+inv.x+invaderOffset,
120+inv.y+drop
);
}
});

bullets.forEach(b=>{
ctx.fillStyle="#ff0066";
ctx.fillRect(b.x,b.y,4,10);
b.y-=6;

invaders.forEach(inv=>{
if(inv.alive){
let ix=w/2-(cols*spacing)/2+inv.x+invaderOffset;
let iy=120+inv.y+drop;
if(b.x>ix&&b.x<ix+32&&b.y>iy&&b.y<iy+32){
inv.alive=false;
explosions.push({x:ix,y:iy,life:20});
}
}
});
});
bullets=bullets.filter(b=>b.y>0);

explosions.forEach(e=>{
ctx.fillStyle="#ff0066";
ctx.shadowColor="#ff0066";
ctx.shadowBlur=20;
ctx.beginPath();
ctx.arc(e.x+16,e.y+16,20-e.life,0,Math.PI*2);
ctx.fill();
ctx.shadowBlur=0;
e.life--;
});
explosions=explosions.filter(e=>e.life>0);

drawPlayer();
requestAnimationFrame(drawBackground);
}
drawBackground();

/* ===== GAME LOGIC ===== */

let games=JSON.parse(localStorage.getItem("games"))||[];

function save(){
localStorage.setItem("games",JSON.stringify(games));
}

async function autoComplete(){
let query=document.getElementById("title").value;
if(query.length<2){
autocompleteResults.style.display="none";
return;
}

let res=await fetch(
`https://api.rawg.io/api/games?key=${API_KEY}&search=${encodeURIComponent(query)}&page_size=5`
);
let data=await res.json();

let box=autocompleteResults;
box.innerHTML="";
box.style.display="block";

data.results.forEach(game=>{
let div=document.createElement("div");
div.className="autocomplete-item";
div.innerHTML=`<span>${game.name}</span>`;
div.onclick=()=>{
title.value=game.name;
box.style.display="none";
};
box.appendChild(div);
});
}

function addGame(){
let t=title.value;
let s=system.value;
if(!t||!s)return alert("Titel & System n√∂tig");
games.push({id:Date.now(),title:t,system:s});
save();
render();
title.value="";
}

function editGame(id){
let g=games.find(x=>x.id===id);
let newTitle=prompt("Neuer Titel:",g.title);
if(newTitle){g.title=newTitle;save();render();}
}

function deleteGame(id){
if(confirm("Wirklich l√∂schen?")){
games=games.filter(g=>g.id!==id);
save();
render();
}
}

function render(){
let lib=document.getElementById("library");
lib.innerHTML="";
lib.className=currentView==="list"?"list-view":"";

let searchVal=search.value.toLowerCase();
let filtered=games.filter(g=>g.title.toLowerCase().includes(searchVal));
let systems=[...new Set(filtered.map(g=>g.system))];
systems.sort((a,b)=>a.localeCompare(b,'de',{sensitivity:'base'}));

systems.forEach(sys=>{
let sec=document.createElement("div");
sec.className="system-section";
sec.innerHTML=`<div class="system-title">${sys}</div><div class="carousel"></div>`;
lib.appendChild(sec);

let car=sec.querySelector(".carousel");

filtered.filter(g=>g.system===sys)
.sort((a,b)=>a.title.localeCompare(b.title,'de',{sensitivity:'base'}))
.forEach(g=>{
car.innerHTML+=`
<div class="card">
<div class="card-icons">
<button class="icon-btn edit-btn" onclick="editGame(${g.id})">‚úè</button>
<button class="icon-btn delete-btn" onclick="deleteGame(${g.id})">üóë</button>
</div>
<div class="card-title">${g.title}</div>
</div>`;
});
});
}

render();

</script>

</body>
</html>